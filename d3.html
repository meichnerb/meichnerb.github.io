---
layout: default
author: Bayley
---
<div>
  <label for="year" style="padding-left: 20px; padding-top:20px">Year</label>
  <input type="range" id="slider" style="margin:20px;">
  <input type="text" id="textbox">
</div>
  <svg height=1000 width=1000></svg>

<script>

    var years = [];

    var draw = function(data, year){
        // var afg = data[0];

        var values =  d3.extent(function(d) {
          return d[year + " [YR" + year + "]"];
        });

        console.log(values);

        var countryNames = data.map(function(d) {
          return d["Country Name"];
        });

        // // var dataMin = d3.min(data, function(d, i) {
        // // 			return values;
        // // });
        // console.log(dataMin);

        var color = d3.scaleOrdinal()
          .domain(values)
          .range(["#012301", "#08f908"]);

        var svg = d3.select("svg");
        var circle = svg.selectAll("circle")
          .data(data);

        var enter = circle.enter().append("circle");

        var cx = function(d, i) {
          return 30 + (30*(i%25));
        };

        var cy = function(d, i) {
          return 30 + (30 * Math.floor(i/25))
        };

        circle.merge(enter).data(data)
          .attr("cx", cx)
          .attr("cy", cy)
          .transition().duration(500)
          .attr("fill", function(d) {
            var num = d[year + "[YR" + year + "]"];
              if (isNaN(parseFloat(num))) {
                return "#cccccc";
              }
              else {
                return color(parseFloat(num));
              }
            })
          .attr("r", 10);
    };


    d3.csv("greenhouse.csv", function(error, data){


      data.forEach(function(d, i){
        for (var key in d) {

          var num = parseFloat(d[key]);
          if (!isNaN(num)) {
            d[key] = num;
          }

        }
      });


      for (var key in data[0]) {
        var num = parseFloat(key.split(" ")[0]);
        if (!isNaN(num)){
          years.push(num);
        }

      }
      var defaultValue = d3.min(years);

      d3.select("#slider")
        .attr("min", d3.min(years))
        .attr("max", d3.max(years))
        .attr("value", defaultValue)
        .on("input", function(){
          d3.select("#textbox").node().value = this.value;
          draw(data, this.value);
        });

        draw(data, d3.min(years));

    });



</script>
